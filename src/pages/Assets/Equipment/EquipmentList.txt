import React from 'react';
import { Card, CardBody, CardHeader, Col, Container, Row, Button } from 'reactstrap';
import TableContainer from "../../../Components/Common/TableContainerReactTable";
import { useEquipment } from './hooks/useEquipment';
import { getEquipmentColumns } from './tableConfig';

const EquipmentList: React.FC = () => {
  const { equipment, loading, error, refreshData } = useEquipment();
  const columns = getEquipmentColumns();

  // Устанавливаем заголовок страницы
  document.title = "Список оборудования | Агро ПО";

  if (loading) {
    return (
      <div className="page-content">
        <Container fluid>
          <Row>
            <Col lg={12}>
              <Card>
                <CardBody className="text-center">
                  <div className="spinner-border text-primary" role="status">
                    <span className="visually-hidden">Загрузка...</span>
                  </div>
                  <p className="mt-2">Загрузка данных оборудования...</p>
                </CardBody>
              </Card>
            </Col>
          </Row>
        </Container>
      </div>
    );
  }

  if (error) {
    return (
      <div className="page-content">
        <Container fluid>
          <Row>
            <Col lg={12}>
              <Card>
                <CardBody className="text-center">
                  <div className="text-danger">
                    <h5>Ошибка загрузки данных</h5>
                    <p>{error}</p>
                    <Button color="primary" onClick={refreshData}>
                      Попробовать снова
                    </Button>
                  </div>
                </CardBody>
              </Card>
            </Col>
          </Row>
        </Container>
      </div>
    );
  }

  return (
    <div className="page-content">
      <Container fluid>
        <Row>
          <Col lg={12}>
            <Card>
              <CardHeader className="d-flex justify-content-between align-items-center">
                <div>
                  <h5 className="card-title mb-0">Список оборудования</h5>
                  <div className="text-muted small">Всего единиц: {equipment.length}</div>
                </div>
                <Button color="primary" size="sm" onClick={refreshData}>
                  Обновить данные
                </Button>
              </CardHeader>
              <CardBody>
                <TableContainer
                  columns={columns}
                  data={equipment}
                  isGlobalFilter={true}
                  customPageSize={10}
                  SearchPlaceholder="Поиск по оборудованию..."
                />
              </CardBody>
            </Card>
          </Col>
        </Row>
      </Container>
    </div>
  );
};

export default EquipmentList;